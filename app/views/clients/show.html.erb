<div class="main-clients-container">
   <header class="clients-header">
      <h1 class="number"><%= "#{@client.first_name} #{@client.last_name}"%></h1>
      <i class="zmdi zmdi-download"></i>
  </header>

  <div class="container-client-info"> <!---This div contains the general infos about client--->
    <div class="item-client-table">
      <table class="text-infos-client">
        <tr>
          <th><p class="text-infos-client">Company:</p></th>
          <td><p class="text-infos-client"><%= @client.company %></p></td>
        </tr>
        <tr>
          <th><p class="text-infos-client">Phone:</p></th>
          <td><p class="text-infos-client"><%= @client.phone_number %></p></td>
        </tr>
        <tr>
          <th><p class="text-infos-client">Email:</p></th>
          <td><p class="text-infos-client"><%= @client.email %></p></td>
        </tr>
        <tr>
          <th><p class="text-infos-client">Client-id:</p></th>
          <td><p class="text-infos-client"><%= @client.id%></p></td>
        </tr>
      </table>
    </div>
    <div class="client-info-buttons">
      <p><%= link_to "Edit", edit_client_path(@client), class: "myButton"%></p>
      <p><%= link_to "Contact", edit_client_path(@client), class: "myButton"%></p>
    </div>
  </div>


  <div> <!---This div contains the activ invoices--->
    <table class="table sortable">
        <thead>
          <tr>
            <th class="text-headers">Invoice-ID</th>
            <th class="text-headers">Start date</th>
            <th class="text-headers">End date</th>
            <th class="text-headers">Price</th>
            <th class="text-headers">Payment confirmed</th>
            <th class="text-headers">Status</th>
            <th class="text-headers">Action</th>
          </tr>
        </thead>
        <tbody>
          <%# current_invoices_client = @client.invoices.select { |invoice| invoice.end_date.after?(Date.today) && invoice.start_date.before?(Date.today)} %>
          <%# future_invoices_client = @client.invoices.select { |invoice| invoice.end_date.after?(Date.today) && invoice.start_date.before?(Date.today)} %>
          <%# past_invoices_client = @client.invoices.select { |invoice| invoice.end_date.after?(Date.today) && invoice.start_date.before?(Date.today)} %>

          <% @client.invoices.order("end_date DESC, start_date").each do |invoice| %>
            <tr>
              <td class="text"><%= invoice.id%></td>
              <td class="text"><%= invoice.start_date %></td>
              <td class="text"><%= invoice.end_date %></td>
              <td class="text"><%= invoice.price %></td>
              <td class="text"><%= invoice.payment_confirmed %></td>
              <!--below the td should vary depending on the status-->
              <% if invoice.end_date.after?(Date.today) && invoice.start_date.before?(Date.today) %>
                <td class="text-activ">Activ</td>
                <% elsif invoice.end_date.after?(Date.today) && invoice.start_date.after?(Date.today) %>
                <td class="text-future">Future</td>
                <% elsif invoice.end_date.before?(Date.today) && invoice.start_date.before?(Date.today) %>
                <td class="text-past">Past</td>
              <% end %>
              <!--below is the delete function for each invoice-->
              <td class="text">
                <%= link_to invoice_path(invoice.id, client_id: @client.id), data: {turbo_method: :delete, turbo_confirm: "Are you sure to delete this invoice?"} do %>
                  <i class="fa-solid fa-trash"></i>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
  </div>

  <div class="buttons-container-client"> <!---This div contains the action buttons--->
    <div class="new-invoice-button">
      <p><%= link_to "Back to clients", clients_path, class: "myButton" %></p>
    </div>
    <div class="back-button">
      <p><%= link_to "New invoice", new_client_invoice_path(@client.id) , class: "myButton"%></p>
    </div>
    <p><%#= link_to "Delete client"%></p>
  </div>
</div>
